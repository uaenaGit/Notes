---
created: 2026-02-27T11:38
updated: 2026-02-27T11:44
---
è¿™æ˜¯ä¸€ä»½ä¸ºæ‚¨ç²¾å¿ƒæ•´ç†çš„ **C++ `std::set` å…¨æ–¹ä½æ–¹æ³•è¯¦è§£**ã€‚

`std::set` æ˜¯åŸºäº**çº¢é»‘æ ‘**å®ç°çš„**æœ‰åºã€å»é‡**å…³è”å®¹å™¨ã€‚è¿™ä»½æŒ‡å—ä¸¥æ ¼éµå¾ª C++11 åŠä»¥ä¸Šæ ‡å‡†ï¼Œ**é‡ç‚¹è¡¥å……äº†æ¯ä¸ªæ–¹æ³•çš„è¯¦ç»†å‚æ•°è¯´æ˜ã€è¿”å›å€¼å«ä¹‰ä»¥åŠå…·ä½“çš„ä»£ç ç¤ºä¾‹**ã€‚

---

# ğŸ“š C++ `std::set` å®Œå…¨æŒ‡å— (C++11+)

### ğŸ“Œ å‰ç½®å‡†å¤‡
```cpp
#include <iostream>
#include <set>
#include <vector>
#include <algorithm> // éƒ¨åˆ†ç®—æ³•å¯èƒ½éœ€è¦

using namespace std;
```

> **æ ¸å¿ƒç‰¹æ€§é€Ÿè§ˆ**ï¼š
> 1. **è‡ªåŠ¨æ’åº**ï¼šé»˜è®¤ä»å°åˆ°å¤§ï¼ˆå¯è‡ªå®šä¹‰ï¼‰ã€‚
> 2. **å”¯ä¸€æ€§**ï¼šæ’å…¥é‡å¤å…ƒç´ ä¼šè‡ªåŠ¨å¤±è´¥ã€‚
> 3. **ä¸å¯ä¿®æ”¹**ï¼šé›†åˆä¸­çš„å…ƒç´ æ˜¯ `const` çš„ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹å€¼ï¼ˆéœ€å…ˆåˆ åæ’ï¼‰ã€‚
> 4. **å¤æ‚åº¦**ï¼šæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤å‡ä¸º $O(\log N)$ã€‚

---

## 1ï¸âƒ£ æ„é€ ä¸æ¨¡æ¿å®šä¹‰ (Construction & Template)
`set` çš„æ¨¡æ¿å®šä¹‰åŒ…å«ä¸¤ä¸ªå…³é”®å‚æ•°ï¼šå…ƒç´ ç±»å‹å’Œæ¯”è¾ƒå‡½æ•°ã€‚

| æ–¹æ³•/å®šä¹‰ | å‚æ•°è¯¦è§£ | è¿”å›å€¼ | åŠŸèƒ½è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| **`template<...>`** | `Key`: å…ƒç´ ç±»å‹`Compare`: æ¯”è¾ƒå‡½æ•°å¯¹è±¡ (é»˜è®¤ `less<Key>`)`Alloc`: åˆ†é…å™¨ (é»˜è®¤ `allocator`) | - | å®šä¹‰ set çš„ç±»å‹ã€‚ |
| **`set()`** | æ—  | - | é»˜è®¤æ„é€ ï¼Œç”Ÿæˆç©ºé›†åˆã€‚ |
| **`set(InputIt first, InputIt last)`** | `first`: èµ·å§‹è¿­ä»£å™¨`last`: ç»“æŸè¿­ä»£å™¨ | - | èŒƒå›´æ„é€ ï¼Œä» `[first, last)` å¤åˆ¶å…ƒç´ å¹¶è‡ªåŠ¨æ’åºå»é‡ã€‚ |
| **`set(const set& other)`** | `other`: å¦ä¸€ä¸ª set | - | æ‹·è´æ„é€ ã€‚ |
| **`set(set&& other)`** | `other`: å³å€¼å¼•ç”¨ (C++11) | - | ç§»åŠ¨æ„é€ ï¼Œçªƒå–èµ„æºï¼Œ`other` å˜ä¸ºç©ºã€‚ |
| **`set(initializer_list<T> init)`** | `init`: åˆå§‹åŒ–åˆ—è¡¨ (C++11) | - | åˆ—è¡¨æ„é€ ï¼Œå¦‚ `{1, 2, 3}`ã€‚ |
| **`set(Compare comp)`** | `comp`: è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°å¯¹è±¡ | - | ä½¿ç”¨è‡ªå®šä¹‰æ’åºè§„åˆ™æ„é€ ï¼ˆå¸¸ç”¨äºé™åºï¼‰ã€‚ |

### ğŸ’» ä»£ç ç¤ºä¾‹
```cpp
int main() {
    // 1. é»˜è®¤æ„é€  (å‡åº)
    set<int> s1; 
    
    // 2. èŒƒå›´æ„é€  (è‡ªåŠ¨å»é‡æ’åº)
    vector<int> v = {5, 2, 9, 2, 1};
    set<int> s2(v.begin(), v.end()); // {1, 2, 5, 9}
    
    // 3. åˆå§‹åŒ–åˆ—è¡¨ (C++11)
    set<int> s3{10, 20, 20, 30}; // {10, 20, 30}
    
    // 4. è‡ªå®šä¹‰æ¯”è¾ƒ (é™åº)
    set<int, greater<int>> s4{5, 2, 9}; // {9, 5, 2}
    
    // 5. ç§»åŠ¨æ„é€  (é«˜æ•ˆ)
    set<int> s5 = move(s3); // s3 å˜ä¸ºç©ºï¼Œs5 æ‹¥æœ‰æ•°æ®
    
    cout << "s2 size: " << s2.size() << endl; // 4
    return 0;
}
```

---

## 2ï¸âƒ£ å®¹é‡ä¸çŠ¶æ€ (Capacity & State)
æŸ¥è¯¢é›†åˆçš„å¤§å°å’ŒçŠ¶æ€ã€‚

| æ–¹æ³• | å‚æ•°è¯¦è§£ | è¿”å›å€¼ | åŠŸèƒ½è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| **`size()`** | æ—  | `size_t` | è¿”å›å½“å‰å…ƒç´ ä¸ªæ•°ã€‚ |
| **`empty()`** | æ—  | `bool` | è‹¥é›†åˆä¸ºç©ºè¿”å› `true`ã€‚ |
| **`max_size()`** | æ—  | `size_t` | è¿”å›ç†è®ºæœ€å¤§å®¹é‡é™åˆ¶ã€‚ |
| **`clear()`** | æ—  | `void` | æ¸…ç©ºæ‰€æœ‰å…ƒç´ ã€‚ |

### ğŸ’» ä»£ç ç¤ºä¾‹
```cpp
int main() {
    set<int> s = {1, 2, 3};
    
    cout << "Size: " << s.size() << endl;      // 3
    cout << "Empty? " << s.empty() << endl;    // 0 (false)
    
    s.clear();
    cout << "After clear, Empty? " << s.empty() << endl; // 1 (true)
    
    return 0;
}
```

---

## 3ï¸âƒ£ å…ƒç´ æ“ä½œ (Element Operations)
æ ¸å¿ƒçš„å¢åˆ æŸ¥æ”¹ï¼ˆæ³¨æ„ï¼šåªèƒ½æŸ¥å’Œåˆ ï¼Œä¸èƒ½ç›´æ¥æ”¹ï¼‰ã€‚

| æ–¹æ³• | å‚æ•°è¯¦è§£ | è¿”å›å€¼ | åŠŸèƒ½è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| **`insert(val)`** | `val`: è¦æ’å…¥çš„å€¼ | `pair<iterator, bool>` | æ’å…¥å…ƒç´ ã€‚`bool`: `true`=æˆåŠŸï¼Œ`false`=å·²å­˜åœ¨ã€‚`iterator`: æŒ‡å‘è¯¥å…ƒç´ çš„è¿­ä»£å™¨ã€‚ |
| **`insert(hint, val)`** | `hint`: æç¤ºä½ç½®è¿­ä»£å™¨`val`: è¦æ’å…¥çš„å€¼ | `iterator` (C++11) | å¸¦æç¤ºæ’å…¥ã€‚è‹¥ `val` ç¡®å®æ’åœ¨ `hint` é™„è¿‘ï¼Œå¤æ‚åº¦å¯ä¼˜åŒ–è‡³ $O(1)$ã€‚ |
| **`erase(val)`** | `val`: è¦åˆ é™¤çš„å€¼ | `size_t` | åˆ é™¤å€¼ä¸º `val` çš„å…ƒç´ ã€‚è¿”å›åˆ é™¤çš„ä¸ªæ•° (0 æˆ– 1)ã€‚ |
| **`erase(it)`** | `it`: è¿­ä»£å™¨ | `iterator` (C++11) | åˆ é™¤è¿­ä»£å™¨æŒ‡å‘çš„å…ƒç´ ã€‚è¿”å›**ä¸‹ä¸€ä¸ª**å…ƒç´ çš„è¿­ä»£å™¨ã€‚ |
| **`erase(first, last)`** | `first`: èµ·å§‹è¿­ä»£å™¨`last`: ç»“æŸè¿­ä»£å™¨ | `iterator` | åˆ é™¤èŒƒå›´ `[first, last)` å†…çš„å…ƒç´ ã€‚è¿”å› `last`ã€‚ |
| **`count(val)`** | `val`: ç›®æ ‡å€¼ | `size_t` | ç»Ÿè®¡å…ƒç´ ä¸ªæ•°ã€‚å¯¹äº `set`ï¼Œè¿”å› **0** (æ— ) æˆ– **1** (æœ‰)ã€‚å¸¸ç”¨äºåˆ¤æ–­å­˜åœ¨æ€§ã€‚ |
| **`find(val)`** | `val`: ç›®æ ‡å€¼ | `iterator` | æŸ¥æ‰¾å…ƒç´ ã€‚æ‰¾åˆ°è¿”å›è¿­ä»£å™¨ï¼Œæœªæ‰¾åˆ°è¿”å› `end()`ã€‚ |
| **`equal_range(val)`** | `val`: ç›®æ ‡å€¼ | `pair<iterator, iterator>` | è¿”å›åŒ…å«æ‰€æœ‰ç­‰äº `val` çš„å…ƒç´ çš„èŒƒå›´ã€‚å¯¹äº `set`ï¼Œå³ `{lower_bound, upper_bound}`ã€‚ |
| **`swap(set& other)`** | `other`: å¦ä¸€ä¸ª set | `void` | äº¤æ¢ä¸¤ä¸ªé›†åˆå†…å®¹ ($O(1)$)ã€‚ |

> âš ï¸ **é‡è¦**ï¼š`set` ä¸­çš„å…ƒç´ æ˜¯ `const` çš„ã€‚ä½ ä¸èƒ½é€šè¿‡è¿­ä»£å™¨ä¿®æ”¹å…ƒç´ å€¼ï¼ˆä¾‹å¦‚ `*it = 5` ä¼šç¼–è¯‘æŠ¥é”™ï¼‰ã€‚è‹¥éœ€ä¿®æ”¹ï¼Œå¿…é¡» `erase` åé‡æ–° `insert`ã€‚

### ğŸ’» ä»£ç ç¤ºä¾‹
```cpp
int main() {
    set<int> s;
    
    // 1. æ’å…¥
    auto ret1 = s.insert(10);
    cout << "Insert 10: " << (ret1.second ? "Success" : "Failed") << endl; // Success
    
    auto ret2 = s.insert(10); // é‡å¤
    cout << "Insert 10 again: " << (ret2.second ? "Success" : "Failed") << endl; // Failed
    
    // 2. æŸ¥æ‰¾ä¸è®¡æ•°
    if (s.count(10)) {
        cout << "10 exists." << endl;
    }
    
    auto it = s.find(10);
    if (it != s.end()) {
        cout << "Found: " << *it << endl;
    }
    
    // 3. åˆ é™¤
    s.erase(10);          // æŒ‰å€¼åˆ é™¤
    s.insert(20);
    s.erase(s.find(20));  // æŒ‰è¿­ä»£å™¨åˆ é™¤ (æ¨èåœ¨éå†ä¸­ä½¿ç”¨)
    
    // 4. èŒƒå›´åˆ é™¤
    s.insert({1, 2, 3, 4, 5});
    auto it_low = s.find(2);
    auto it_high = s.find(4);
    s.erase(it_low, it_high); // åˆ é™¤ [2, 4)ï¼Œå³åˆ é™¤ 2, 3ã€‚ä¿ç•™ 4ã€‚
    
    // 5. å°è¯•ä¿®æ”¹ (é”™è¯¯ç¤ºèŒƒ)
    // *s.begin() = 99; // âŒ ç¼–è¯‘é”™è¯¯ï¼å…ƒç´ æ˜¯ const çš„
    
    return 0;
}
```

---

## 4ï¸âƒ£ é¡ºåºæŸ¥æ‰¾ä¸è¾¹ç•Œ (Ordered Search & Bounds)
åˆ©ç”¨çº¢é»‘æ ‘çš„æœ‰åºæ€§è¿›è¡Œé«˜æ•ˆèŒƒå›´æŸ¥è¯¢ï¼Œè¿™æ˜¯ `set` æœ€å¼ºå¤§çš„åŠŸèƒ½ã€‚

| æ–¹æ³• | å‚æ•°è¯¦è§£ | è¿”å›å€¼ | åŠŸèƒ½è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| **`lower_bound(val)`** | `val`: ç›®æ ‡å€¼ | `iterator` | è¿”å›**ç¬¬ä¸€ä¸ªå¤§äºç­‰äº** (`>=`) `val` çš„å…ƒç´ çš„è¿­ä»£å™¨ã€‚è‹¥éƒ½å°ï¼Œè¿”å› `end()`ã€‚ |
| **`upper_bound(val)`** | `val`: ç›®æ ‡å€¼ | `iterator` | è¿”å›**ç¬¬ä¸€ä¸ªå¤§äº** (`>`) `val` çš„å…ƒç´ çš„è¿­ä»£å™¨ã€‚è‹¥éƒ½å°ï¼Œè¿”å› `end()`ã€‚ |
| **`equal_range(val)`** | `val`: ç›®æ ‡å€¼ | `pair<iterator, iterator>` | ç­‰ä»·äº `{lower_bound(val), upper_bound(val)}`ã€‚è¿”å›åŒ…å«æ‰€æœ‰ç­‰äº `val` çš„èŒƒå›´ã€‚ |

### ğŸ’¡ åº”ç”¨åœºæ™¯
- **æŸ¥æ‰¾åŒºé—´**ï¼š`[lower_bound(L), upper_bound(R))` å³ä¸ºå€¼åœ¨ `[L, R]` èŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ ã€‚
- **æŸ¥æ‰¾å‰é©±/åç»§**ï¼šåˆ©ç”¨ `lower_bound` æ‰¾åˆ°ä½ç½®åï¼Œå‰åç§»åŠ¨è¿­ä»£å™¨ã€‚

### ğŸ’» ä»£ç ç¤ºä¾‹
```cpp
int main() {
    set<int> s = {10, 20, 30, 40, 50};
    
    // 1. lower_bound: >= 25 çš„ç¬¬ä¸€ä¸ªæ•°
    auto it_low = s.lower_bound(25); 
    if (it_low != s.end()) cout << ">= 25: " << *it_low << endl; // 30
    
    // 2. upper_bound: > 30 çš„ç¬¬ä¸€ä¸ªæ•°
    auto it_up = s.upper_bound(30);
    if (it_up != s.end()) cout << "> 30: " << *it_up << endl;    // 40
    
    // 3. æŸ¥æ‰¾åŒºé—´ [20, 40] å†…çš„æ‰€æœ‰å…ƒç´ 
    // èŒƒå›´æ˜¯ [lower_bound(20), upper_bound(40))
    auto start = s.lower_bound(20);
    auto end = s.upper_bound(40);
    
    cout << "Elements in [20, 40]: ";
    for (auto it = start; it != end; ++it) {
        cout << *it << " "; // 20 30 40
    }
    cout << endl;
    
    // 4. æŸ¥æ‰¾ä¸å­˜åœ¨çš„æ•°çš„ä¸‹ç•Œ
    auto it_miss = s.lower_bound(25); // 30
    auto it_prev = prev(it_miss);     // 20 (å‰ä¸€ä¸ªå…ƒç´ ï¼Œå³ < 25 çš„æœ€å¤§å€¼)
    cout << "< 25 max: " << *it_prev << endl;
    
    return 0;
}
```

---

## 5ï¸âƒ£ æ¯”è¾ƒä¸è¿­ä»£ (Comparison & Iteration)

| æ–¹æ³• | å‚æ•°è¯¦è§£ | è¿”å›å€¼ | åŠŸèƒ½è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| **`operator==, !=`****`<, <=, >, >=`** | `rhs`: å¦ä¸€ä¸ª set | `bool` | å­—å…¸åºæ¯”è¾ƒä¸¤ä¸ªé›†åˆï¼ˆé€ä¸ªå…ƒç´ æ¯”è¾ƒï¼‰ã€‚ |
| **`begin()` / `end()`** | æ—  | `iterator` | æ­£å‘è¿­ä»£å™¨ã€‚`*it` æ˜¯ `const T&`ã€‚ |
| **`rbegin()` / `rend()`** | æ—  | `reverse_iterator` | åå‘è¿­ä»£å™¨ï¼ˆä»å¤§åˆ°å°éå†ï¼‰ã€‚ |
| **`cbegin()` / `cend()`** | æ—  | `const_iterator` | åªè¯»è¿­ä»£å™¨ã€‚ |

### ğŸ’» ä»£ç ç¤ºä¾‹
```cpp
int main() {
    set<int> s1 = {1, 2, 3};
    set<int> s2 = {1, 2, 3};
    set<int> s3 = {1, 2, 4};
    
    // æ¯”è¾ƒ
    cout << (s1 == s2) << endl; // 1 (true)
    cout << (s1 < s3) << endl;  // 1 (true, å› ä¸º 3 < 4)
    
    // æ­£å‘éå†
    cout << "Forward: ";
    for (int x : s1) cout << x << " "; // 1 2 3
    cout << endl;
    
    // åå‘éå† (ä»å¤§åˆ°å°)
    cout << "Reverse: ";
    for (auto it = s1.rbegin(); it != s1.rend(); ++it) {
        cout << *it << " "; // 3 2 1
    }
    cout << endl;
    
    // å®‰å…¨åˆ é™¤éå† (C++11 erase è¿”å›ä¸‹ä¸€ä¸ªè¿­ä»£å™¨)
    for (auto it = s3.begin(); it != s3.end(); ) {
        if (*it % 2 == 0) {
            it = s3.erase(it); // åˆ é™¤å¶æ•°
        } else {
            ++it;
        }
    }
    // s3 ç°åœ¨åªåŒ…å« {1}
    
    return 0;
}
```

---

## 6ï¸âƒ£ é«˜çº§æŠ€å·§ä¸è‡ªå®šä¹‰ç±»å‹

### A. è‡ªå®šä¹‰ç»“æ„ä½“ä½œä¸º Key
å¦‚æœ `Key` æ˜¯è‡ªå®šä¹‰ç±»ï¼Œå¿…é¡»æä¾›æ¯”è¾ƒè§„åˆ™ï¼ˆé‡è½½ `<` æˆ–ä¼ å…¥ä»¿å‡½æ•°ï¼‰ã€‚

```cpp
struct Person {
    string name;
    int age;
    // å¿…é¡»é‡è½½ < è¿ç®—ç¬¦
    bool operator<(const Person& other) const {
        if (age != other.age) return age < other.age; // å…ˆæ¯”å¹´é¾„
        return name < other.name;                     // å†æ¯”åå­—
    }
};

int main() {
    set<Person> people;
    people.insert({"Alice", 25});
    people.insert({"Bob", 20});
    people.insert({"Charlie", 25}); // å¹´é¾„ç›¸åŒï¼Œåå­—ä¸åŒï¼Œä¼šä¿ç•™
    
    // éå†æ—¶å·²æŒ‰å¹´é¾„æ’åºï¼ŒåŒé¾„æŒ‰åå­—æ’åº
    for (const auto& p : people) {
        cout << p.name << "(" << p.age << ") ";
    }
    // è¾“å‡º: Bob(20) Alice(25) Charlie(25)
    return 0;
}
```

### B. `set` vs `unordered_set` vs `vector`

| ç‰¹æ€§ | `std::set` | `std::unordered_set` | `std::vector` |
| :--- | :--- | :--- | :--- |
| **åº•å±‚** | çº¢é»‘æ ‘ | å“ˆå¸Œè¡¨ | åŠ¨æ€æ•°ç»„ |
| **æ’åº** | **è‡ªåŠ¨æœ‰åº** | æ— åº | éœ€æ‰‹åŠ¨ `sort` |
| **å”¯ä¸€æ€§** | å”¯ä¸€ | å”¯ä¸€ | å¯é‡å¤ |
| **æŸ¥æ‰¾** | $O(\log N)$ | **å¹³å‡ $O(1)$** | $O(N)$ |
| **èŒƒå›´æŸ¥è¯¢** | **æ”¯æŒ** (`lower_bound`) | ä¸æ”¯æŒ | éœ€æ’åºåäºŒåˆ† |
| **é€‚ç”¨åœºæ™¯** | éœ€è¦æœ‰åºã€èŒƒå›´æŸ¥æ‰¾ | ä»…éœ€å¿«é€Ÿå»é‡/æŸ¥æ‰¾ | éšæœºè®¿é—®ã€ç¼“å­˜å‹å¥½ |

---

### ğŸ’¡ æ ¸å¿ƒæ€»ç»“
1. **å”¯ä¸€ä¸”æœ‰åº**ï¼š`set` è‡ªåŠ¨å¸®ä½ å»é‡å¹¶æ’åºï¼Œçœå»æ‰‹åŠ¨ `sort` + `unique` çš„æ­¥éª¤ã€‚
2. **æŸ¥æ‰¾åˆ©å™¨**ï¼šåˆ©ç”¨ `lower_bound` å’Œ `upper_bound` å¯ä»¥é«˜æ•ˆè§£å†³â€œæŸ¥æ‰¾èŒƒå›´å†…æ‰€æœ‰å…ƒç´ â€çš„é—®é¢˜ã€‚
3. **åªè¯»å…ƒç´ **ï¼šè®°ä½ `*it = val` æ˜¯éæ³•çš„ã€‚æƒ³æ”¹ï¼Ÿå…ˆ `erase` å† `insert`ã€‚
4. **éå†åˆ é™¤**ï¼šä½¿ç”¨ `it = s.erase(it)` æ¨¡å¼å®‰å…¨åˆ é™¤å…ƒç´ ã€‚
5. **é€‰æ‹©å»ºè®®**ï¼š
   - éœ€è¦**æœ‰åº**æˆ–**èŒƒå›´æŸ¥è¯¢** $\rightarrow$ `std::set`
   - åªéœ€è¦**å¿«é€ŸæŸ¥æ‰¾/å»é‡**ï¼Œä¸åœ¨ä¹é¡ºåº $\rightarrow$ `std::unordered_set` (æ›´å¿«)
   - æ•°æ®é‡å°æˆ–éœ€è¦**ä¸‹æ ‡è®¿é—®** $\rightarrow$ `std::vector`